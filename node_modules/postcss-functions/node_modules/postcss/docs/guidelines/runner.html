<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      # PostCSS Runner GuidelinesA PostCSS runner is a tool that processes CSS
      through a user-defined listof plugins; for example, [`postcss-cli`]
      or [`gulp‑postcs...
    </title>
    <meta
      name="description"
      content="# PostCSS Runner GuidelinesA PostCSS runner is a tool that processes CSS through a user-defined listof plugins; for example, [`postcss-cli`] or [`gulp‑postcs..."
    />
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png" />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="/apple-icon-114x114.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="120x120"
      href="/apple-icon-120x120.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="144x144"
      href="/apple-icon-144x144.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="152x152"
      href="/apple-icon-152x152.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/apple-icon-180x180.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="/android-icon-192x192.png"
    />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="msapplication-TileColor" content="#90cdf4" />
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png" />
    <meta name="theme-color" content="#90cdf4" />

    <link
      rel="stylesheet"
      type="text/css"
      href="/pages/datashaman/sup.datashaman.com/styles/main.css"
    />
    <link
      rel="canonical"
      href="https://sup.datashaman.com/pages/datashaman/sup.datashaman.com/node_modules/postcss-functions/node_modules/postcss/docs/guidelines/runner.html"
    />
    <link
      rel="alternate"
      type="application/rss+xml"
      title="sup"
      href="https://sup.datashaman.com/pages/datashaman/sup.datashaman.com/feed.xml"
    />
    <script src="/scripts/feather.min.js" defer></script>
    <script src="/scripts/main.js" defer></script>
  </head>

  <body class="bg-gray-300">
    <div class="container md:mx-auto p-4 md:flex">
      <aside class="flex-none md:w-56 text-center">
        <header
          class="bg-blue-300 text-4xl md:text-6xl p-2 mb-4 rounded shadow"
        >
          <h1><a href="/">sup</a></h1>
        </header>

        <div class="bg-yellow-300 text-base md:text-xl p-2 mb-4 rounded shadow">
          random thoughts.<br />pithy observations.<br />some gear-grinding.
        </div>

        <div class="bg-green-300 p-2 mb-4 md:mb-0 rounded shadow">
          <ul class="list-none">
            <li class="inline-block p-2">
              <a
                href="https://github.com/datashaman"
                target="_blank"
                rel="noopener noreferer"
                aria-label="github"
              >
                <i data-feather="github"></i>
              </a>
            </li>
            <li class="inline-block p-2">
              <a
                href="https://twitter.com/data_shaman"
                target="_blank"
                rel="noopener noreferer"
                aria-label="twitter"
              >
                <i data-feather="twitter"></i>
              </a>
            </li>
            <li class="inline-block p-2">
              <a
                href="/pages/datashaman/sup.datashaman.com/feed.xml"
                target="_blank"
                rel="noopener noreferer"
                aria-label="rss feed"
              >
                <i data-feather="rss"></i>
              </a>
            </li>
          </ul>
        </div>
      </aside>

      <section class="flex-grow md:px-4">
        <article class="bg-white p-4 mb-4 rounded shadow">
          <a
            href="/node_modules/postcss-functions/node_modules/postcss/docs/guidelines/runner.html"
            ><h2>PostCSS Runner Guidelines</h2></a
          >
          <hr />
          <h1 id="postcss-runner-guidelines">PostCSS Runner Guidelines</h1>

          <p>
            A PostCSS runner is a tool that processes CSS through a user-defined
            list of plugins; for example,
            <a href="https://github.com/postcss/postcss-cli"
              ><code class="highlighter-rouge">postcss-cli</code></a
            >
            or
            <a href="https://github.com/w0rm/gulp-postcss"
              ><code class="highlighter-rouge">gulp‑postcss</code></a
            >. These rules are mandatory for any such runners.
          </p>

          <p>
            For single-plugin tools, like
            <a href="https://github.com/sindresorhus/gulp-autoprefixer"
              ><code class="highlighter-rouge">gulp-autoprefixer</code></a
            >, these rules are not mandatory but are highly recommended.
          </p>

          <p>
            See also
            <a
              href="http://blog.clojurewerkz.org/blog/2013/04/20/how-to-make-your-open-source-project-really-awesome/"
              >ClojureWerkz’s recommendations</a
            >
            for open source projects.
          </p>

          <h2 id="1-api">1. API</h2>

          <h3 id="11-accept-functions-in-plugin-parameters">
            1.1. Accept functions in plugin parameters
          </h3>

          <p>
            If your runner uses a config file, it must be written in JavaScript,
            so that it can support plugins which accept a function, such as
            <a href="https://github.com/borodean/postcss-assets"
              ><code class="highlighter-rouge">postcss-assets</code></a
            >:
          </p>

          <div class="language-js highlighter-rouge">
            <div class="highlight">
              <pre
                class="highlight"
              ><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">postcss-assets</span><span class="dl">'</span><span class="p">)({</span>
        <span class="na">cachebuster</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">file</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">statSync</span><span class="p">(</span><span class="nx">file</span><span class="p">).</span><span class="nx">mtime</span><span class="p">.</span><span class="nx">getTime</span><span class="p">().</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">})</span>
<span class="p">];</span>
</code></pre>
            </div>
          </div>

          <h2 id="2-processing">2. Processing</h2>

          <h3 id="21-set-from-and-to-processing-options">
            2.1. Set <code class="highlighter-rouge">from</code> and
            <code class="highlighter-rouge">to</code> processing options
          </h3>

          <p>
            To ensure that PostCSS generates source maps and displays better
            syntax errors, runners must specify the
            <code class="highlighter-rouge">from</code> and
            <code class="highlighter-rouge">to</code> options. If your runner
            does not handle writing to disk (for example, a gulp transform), you
            should set both options to point to the same file:
          </p>

          <div class="language-js highlighter-rouge">
            <div class="highlight">
              <pre
                class="highlight"
              ><code><span class="nx">processor</span><span class="p">.</span><span class="nx">process</span><span class="p">({</span> <span class="na">from</span><span class="p">:</span> <span class="nx">file</span><span class="p">.</span><span class="nx">path</span><span class="p">,</span> <span class="na">to</span><span class="p">:</span> <span class="nx">file</span><span class="p">.</span><span class="nx">path</span> <span class="p">});</span>
</code></pre>
            </div>
          </div>

          <h3 id="22-use-only-the-asynchronous-api">
            2.2. Use only the asynchronous API
          </h3>

          <p>
            PostCSS runners must use only the asynchronous API. The synchronous
            API is provided only for debugging, is slower, and can’t work with
            asynchronous plugins.
          </p>

          <div class="language-js highlighter-rouge">
            <div class="highlight">
              <pre
                class="highlight"
              ><code><span class="nx">processor</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="nx">opts</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// processing is finished</span>
<span class="p">});</span>
</code></pre>
            </div>
          </div>

          <h3 id="23-use-only-the-public-postcss-api">
            2.3. Use only the public PostCSS API
          </h3>

          <p>
            PostCSS runners must not rely on undocumented properties or methods,
            which may be subject to change in any minor release. The public API
            is described in <a href="http://api.postcss.org/">API docs</a>.
          </p>

          <h2 id="3-output">3. Output</h2>

          <h3 id="31-dont-show-js-stack-for-csssyntaxerror">
            3.1. Don’t show JS stack for
            <code class="highlighter-rouge">CssSyntaxError</code>
          </h3>

          <p>
            PostCSS runners must not show a stack trace for CSS syntax errors,
            as the runner can be used by developers who are not familiar with
            JavaScript. Instead, handle such errors gracefully:
          </p>

          <div class="language-js highlighter-rouge">
            <div class="highlight">
              <pre
                class="highlight"
              ><code><span class="nx">processor</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="nx">opts</span><span class="p">).</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nx">error</span><span class="p">.</span><span class="nx">name</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">CssSyntaxError</span><span class="dl">'</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">process</span><span class="p">.</span><span class="nx">stderr</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span> <span class="o">+</span> <span class="nx">error</span><span class="p">.</span><span class="nx">showSourceCode</span><span class="p">());</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre>
            </div>
          </div>

          <h3 id="32-display-resultwarnings">
            3.2. Display
            <code class="highlighter-rouge">result.warnings()</code>
          </h3>

          <p>
            PostCSS runners must output warnings from
            <code class="highlighter-rouge">result.warnings()</code>:
          </p>

          <div class="language-js highlighter-rouge">
            <div class="highlight">
              <pre
                class="highlight"
              ><code><span class="nx">result</span><span class="p">.</span><span class="nx">warnings</span><span class="p">().</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">warn</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">process</span><span class="p">.</span><span class="nx">stderr</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">warn</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
<span class="p">});</span>
</code></pre>
            </div>
          </div>

          <p>
            See also
            <a href="https://github.com/davidtheclark/postcss-log-warnings"
              >postcss-log-warnings</a
            >
            and
            <a href="https://github.com/postcss/postcss-messages"
              >postcss-messages</a
            >
            plugins.
          </p>

          <h3 id="33-allow-the-user-to-write-source-maps-to-different-files">
            3.3. Allow the user to write source maps to different files
          </h3>

          <p>
            PostCSS by default will inline source maps in the generated file;
            however, PostCSS runners must provide an option to save the source
            map in a different file:
          </p>

          <div class="language-js highlighter-rouge">
            <div class="highlight">
              <pre
                class="highlight"
              ><code><span class="k">if</span> <span class="p">(</span> <span class="nx">result</span><span class="p">.</span><span class="nx">map</span> <span class="p">)</span> <span class="p">{</span>
    <span class="nx">fs</span><span class="p">.</span><span class="nx">writeFile</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">to</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">.map</span><span class="dl">'</span><span class="p">,</span> <span class="nx">result</span><span class="p">.</span><span class="nx">map</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
<span class="p">}</span>
</code></pre>
            </div>
          </div>

          <h2 id="4-documentation">4. Documentation</h2>

          <h3 id="41-document-your-runner-in-english">
            4.1. Document your runner in English
          </h3>

          <p>
            PostCSS runners must have their
            <code class="highlighter-rouge">README.md</code> written in English.
            Do not be afraid of your English skills, as the open source
            community will fix your errors.
          </p>

          <p>
            Of course, you are welcome to write documentation in other
            languages; just name them appropriately (e.g.
            <code class="highlighter-rouge">README.ja.md</code>).
          </p>

          <h3 id="42-maintain-a-changelog">4.2. Maintain a changelog</h3>

          <p>
            PostCSS runners must describe changes of all releases in a separate
            file, such as <code class="highlighter-rouge">ChangeLog.md</code>,
            <code class="highlighter-rouge">History.md</code>, or with
            <a href="https://help.github.com/articles/creating-releases/"
              >GitHub Releases</a
            >. Visit
            <a href="http://keepachangelog.com/">Keep A Changelog</a> for more
            information on how to write one of these.
          </p>

          <p>
            Of course you should use <a href="http://semver.org/">SemVer</a>.
          </p>

          <h3 id="43-postcss-runner-keyword-in-packagejson">
            4.3. <code class="highlighter-rouge">postcss-runner</code> keyword
            in <code class="highlighter-rouge">package.json</code>
          </h3>

          <p>
            PostCSS runners written for npm must have the
            <code class="highlighter-rouge">postcss-runner</code> keyword in
            their <code class="highlighter-rouge">package.json</code>. This
            special keyword will be useful for feedback about the PostCSS
            ecosystem.
          </p>

          <p>
            For packages not published to npm, this is not mandatory, but
            recommended if the package format is allowed to contain keywords.
          </p>
        </article>
      </section>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        feather.replace({
          width: 32,
          height: 32,
        });
      });
    </script>
  </body>
</html>
